#!/usr/bin/env bash
# ============================================================
# ğŸš€ mc-export.sh â€” Build + Export project Minecraft (Termux, rsync progress)
# ============================================================

set -e

run_build=true
project_name=$(basename "$PWD")
project_name=${project_name#mc-}          # hapus prefix mc- jika ada
target_dir="$HOME/storage/downloads/Termux/mc-$project_name"


# --- Parsing argumen ---
while [[ "$#" -gt 0 ]]; do
  case "$1" in
    --from)
      target_dir="$2"
      shift
      ;;
    *)
      echo "âŒ Argumen tidak dikenal: $1"
      echo "   Gunakan: mc-import [--from <target_dir>]"
      exit 1
      ;;
  esac
  shift
done

echo "ğŸš€ Importing project: $project_name"
echo "ğŸ“‚ Target: $target_dir"
echo

# --- 3ï¸âƒ£ Sync ke target ---
echo "ğŸ“¦ Menyalin hasil ke target:"
echo "    $target_dir"
echo

mkdir -p "$target_dir"

rsync -avh --delete --info=progress2 \
  --exclude 'node_modules' \
  --exclude '.git' \
  --exclude '.env' \
  --exclude '*.log' \
  "$target_dir/" ./

echo
echo "ğŸ‰ Import selesai: $target_dir"
termux-toast "Import project $project_name selesai!"
